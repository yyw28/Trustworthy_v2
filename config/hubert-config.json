{
  "data": {
    "batch_size": 4,
    "num_workers": 2,
    "combined_csv": "/Users/yuwenyu/Desktop/trustworthy_matt/Trustworthy_v2/combined_dataset.csv",
    "datasets": {
      "tis": "/Users/yuwenyu/Desktop/trustworthy_classifier_standalone/tis",
      "cxd": "/Users/yuwenyu/Desktop/trustworthy_matt/Trustworthy_v2/CXD"
    }
  },
  "model": {
    "hubert_model_name": "facebook/hubert-base-ls960",
    "trainable_layers": 2
  },
  "optimizer": {
    "class_path": "Adam",
    "init_args": {
      "lr": 0.000001
    }
  },
  "trainer": {
    "accelerator": "mps",
    "devices": 1,
    "max_epochs": 100,
    "accumulate_grad_batches": 2,
    "callbacks": [
      {
        "class_path": "lightning.pytorch.callbacks.EarlyStopping",
        "init_args": {
          "mode": "min",
          "monitor": "validation_loss",
          "patience": 5,
          "min_delta": 0.001
        }
      },
      {
        "class_path": "lightning.pytorch.callbacks.ModelCheckpoint",
        "init_args": {
          "filename": "best-checkpoint-{epoch}-{validation_loss:.5f}-{validation_accuracy:.5f}",
          "mode": "min",
          "monitor": "validation_loss",
          "save_top_k": 1,
          "save_on_train_epoch_end": false
        }
      },
      {
        "class_path": "lightning.pytorch.callbacks.ModelCheckpoint",
        "init_args": {
          "save_last": true
        }
      }
    ],
    "logger": {
      "class_path": "lightning.pytorch.loggers.TensorBoardLogger",
      "init_args": {
        "default_hp_metric": false,
        "name": "hubert-finetune",
        "save_dir": "lightning_logs"
      }
    },
    "precision": "16-mixed"
  }
}
